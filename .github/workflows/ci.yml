# This workflow will install Python dependencies, run tests and lint with a single version of Python
# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-python

name: CI/CD

on:
  push:
    branches:
      - main
      - dev
  pull_request:
    branches: ["main", "dev"]

# Minimal read permission is enough for CI jobs that don't modify the repo.
permissions:
  contents: read

jobs:
  build:
    name: Test, Lint, Type Check & Format
    strategy:
      matrix:
        python-version: ["3.13"]
        os: [ubuntu-latest]
    runs-on: ${{ matrix.os }}

    steps:
      # Checkout repository (v5 is the current major version)
      - uses: actions/checkout@v5

      # Use the packaged 'uv' environment setup used by this project.
      # If you prefer the standard setup-python, replace this with actions/setup-python@v4
      - name: Set up Python ${{ matrix.python-version }}
        uses: astral-sh/setup-uv@v6
        with:
          python-version: ${{ matrix.python-version }}

      - name: Install development dependencies (uv sync)
        run: uv sync --frozen || true

      - name: Ruff - format check
        run: uv run ruff format --check --diff

      - name: Ruff - lint & fix
        run: uv run ruff check --fix pyqtui tests examples || true

      # Uncomment the test step if you want the CI to run unit tests.
      # - name: Run tests
      #   run: uv run pytest
